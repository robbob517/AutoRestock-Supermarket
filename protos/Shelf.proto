#VRML_SIM R2025a utf8
# Describe the functionality of your PROTO here.
# template language: javascript


PROTO Shelf [
  field SFVec3f translation 0 0 1
  field SFRotation rotation 1 0 0 1.5708
  field SFString name "shelf"
  field SFFloat height 2
  field SFFloat width 2
  field SFFloat depth 0.5
  field SFFloat shelfCount 4
  field SFFloat thickness 0.05
]
{
  %<
      let h = fields.height.value;
      let w = fields.width.value;
      let d = fields.depth.value;
      let sc = fields.shelfCount.value;
      let t = fields.thickness.value;

      let shelfSpacing = ( h - (sc * t) / (sc - 1) )
      if (sc < 2)
        shelfSpacing = 0
      >%

  Solid {
    translation IS translation
    rotation IS rotation
    name IS name

    children[
      # Back Panel
      Transform {
        translation 0 %<= h/2 >% %<= -d/2 + t/2 >%
        children [
          Shape {
            appearance PBRAppearance {}
            geometry Box {size %<=w>% %<=h>% %<=t>%}
          }
        ]
      }

      # Left Side Panel
      Transform {
        translation %<= -w/2 + t/2 >% %<= h/2 >% 0
        rotation 0 1 0 1.5708
        children [
          Shape {
            appearance PBRAppearance {}
            geometry Box {size %<=d>% %<=h>% %<=t>%}
          }
        ]
      }

      # Right Side Panel
      Transform {
        translation %<= w/2 - t/2 >% %<= h/2 >% 0
        rotation 0 1 0 1.5708
        children [
          Shape {
            appearance PBRAppearance {}
            geometry Box {size %<=d>% %<=h>% %<=t>%}
          }
        ]
      }

      # Shelves
      
    ]
  }
}
